{% extends "streampunk/base_list.html" %}
{% comment %}
This file is part of Streampunk, a Django application for convention programmes
Copyright (C) 2012 Stephen Kilbane
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}
{% load streampunk_filters %}
{% block title %}People{% endblock %}
{% block list_content %}
{% for person_list in sorted_data %}
{% cycle 'Col1' 'Col2' 'Col3' 'Col4' 'Col5' as colname silent %}
<div id="{{ colname }}">
<form action="{% url make_personlist %}" method="post">
{% csrf_token %}
<table border>
<tr class="list_header">
  <th>{% colheader "First" colname "Col3" %}</th>
  <th>{% colheader "Middle" colname "Col2" %}</th>
  <th>{% colheader "Last" colname "Col1" %}</th>
  <th>{% colheader "Badge" colname "Col4" %}</th>
</tr>
{% for person in person_list %}
<tr>
{% if perms.streampunk.read_private %}
  <td colspan="4"> {{ person|linky|safe }} </td>
{% else %}
  <td> {{ person|linky:person.as_badge|safe }} </td>
{% endif %}
{% if perms.streampunk.send_mass_email %}
  <td>
       <input type="checkbox" name="somepeople" value="{{ person.id }}" />
       <input type="hidden" name="allpeople" value="{{ person.id }}" />
  {% if person.email %}
     Email/Select?
  {% else %}
     Select?
  {% endif %}
  </td>
{% endif %}
</tr>
{% empty %}
  <tr><td>No people yet</td></tr>
{% endfor %}
</table>
<input type="hidden" name="listname" value="People List for {{ user.username }}" />
{% if perms.streampunk.send_mass_email %}
<input type="submit" name="email_all" value="Email all these people" />
<input type="submit" name="email_some" value="Email selected people" />
<br/>
{% endif %}
{% if perms.streampunk.edit_programme or perms.streampunk.edit_kit %}
<input type="submit" name="save_all" value="Save the people on this item as a list" />
<input type="submit" name="save_some" value="Save selected people as a list" />
{% endif %}
</form>

</div>
{% endfor %}
{% if perms.streampunk.edit_programme %}
<p><a href="{{ new_url }}">Add new {{ verbose_name }}</a>.</p>
{% endif %}
{% endblock %}
