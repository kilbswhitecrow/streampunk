{% extends "mimo/base.html" %}
{% comment %}
This file is part of Streampunk, a Django application for convention programmes
Copyright (C) 2012-2017 Stephen Kilbane
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}
{% block title %}Move In Index{% endblock %}
{% block body_content %}
{% if items %}
  <table border="1">
  <tr>
  <th>Code</th>
  <th>Kind</th>
  <th>Subkind</th>
  <th>Count</th>
  <th>State</th>
  <th>Room</th>
  <th colspan="3">Operations</th>
  </tr>
  {% for item in items %}
  {% ifchanged %}
    <tr><td colspan="9" align="center"><em>{{ item.item.group}}</em></td></tr>
  {% endifchanged %}
    <tr>
    <td> <a href="{% url "mi_detail" item.item.id %}">{{ item.item.code }}</a> </td>
    <td>{{ item.item.kind }}</td>
    <td>{{ item.item.subkind }}</td>
    <td align="right">{{ item.item.count }}</td>
    <td>{{ item.item.state }}</td>
    <td>{{ item.item.room }}</td>
    <td>
{% if item.item.state == 'Arranged' or item.item.state == 'Planned' %}
    <form action="{% url "mi_received" item.pk %}" method="POST">
    {% csrf_token %}
    <input type="submit" value="Mark Received" />
    </form>
{% else %}
    <form action="{% url "mi_reset" item.pk %}" method="POST">
    {% csrf_token %}
    <input type="submit" value="Reset" />
    </form>
{% endif %}
    </td>
    <td>
{% if item.item.state == 'Arranged' or item.item.state == 'Planned' %}
    <form action="{% url "mi_not_received" item.pk %}" method="POST">
    {% csrf_token %}
    <input type="submit" value="Mark Not Received" />
    </form>
{% else %}
    <form action="{% url "mi_reset" item.pk %}" method="POST">
    {% csrf_token %}
    <input type="submit" value="Reset" />
    </form>
{% endif %}
    </td>
    <td>
    <form action="{% url "mi_replace" item.pk %}" method="POST">
    {% csrf_token %}
    <input type="submit" value="Replace" />
    </form>
    </td>
    </tr>
  {% endfor %}
  </table>
{% else %}
  <p>No items yet.</p>
  <p>
  <form action="{% url "mi_setup" %}" method="POST">
  {% csrf_token %}
  <input type="submit" value="Setup" />
  </form>
  </p>
{% endif %}
{% endblock %}
